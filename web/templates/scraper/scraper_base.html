{% extends "frontend/base.html" %}

{% block title %}{{ scraper.title }}{% endblock %}
{% block rss %}<link rel="alternate" type="application/rss+xml" title="RSS" href="/feeds/scraper_comments/{{ scraper.short_name }}" />{% endblock %}

{% block content %}
    <div class="page_title">
	    <h1>
	        {{ scraper.title }}
	        {% if scraper.has_geo %}
                <img src="{{ MEDIA_URL }}/images/icons/map.png"/>
            {% endif %}
            {% if scraper.has_temporal %}                        
                <img src="{{ MEDIA_URL }}/images/icons/date.png"/>
            {% endif %}
	    </h1>	    
    </div>
    <div class="content col left">
  	  {% if scraper.is_published %}
  		  <p>Published</p>
  	  {% endif %}

  	  <div>
					{% if user.is_authenticated %}
	    {% if not user_owns_it   %}
{% comment %} [APS: remove following/watching features for now]
  					{% if user_follows_it %}
  		  				<p>You are watching this scraper, and will be alerted if it changes or appears to be broken. 
	
							<form method="get" action="{% url scraper_unfollow scraper.short_name %}">
                  				<input type="submit" value="Stop watching" />
              				</form>
						</p>

  		   			{% else %} 

             			<p>
              				<form method="get" action="{% url scraper_follow scraper.short_name %}">
                  				<input type="submit" value="Watch scraper" /> (You will be alerted if this scraper changes or appears to be broken)
              				</form>
              			</p> 
					{% endif %}
{% endcomment %} 
  		   				{% else %} 
						You own this scraper
  						{% endif %}
  						{% endif %}
  	  </div>


    </div>
    <div class="content full">
        <div class="page_tabs">
            <ul>
                <li{% ifequal selected_tab "overview" %} class="selected"{% endifequal %}>
                    <a href="{% url scraper_overview scraper.short_name %}">Overview</a>
                </li>
                <li{% ifequal selected_tab "data" %} class="selected"{% endifequal %}>
                    <a href="{% url scraper_data scraper.short_name %}">Data</a>
                </li>
                {% if scraper.has_geo %}
                    <li{% ifequal selected_tab "map" %} class="selected"{% endifequal %}>
                        <a href="{% url scraper_map scraper.short_name %}">Map</a>
                    </li>
                {% endif %}
                <li{% ifequal selected_tab "code" %} class="selected"{% endifequal %}>
                    <a href="{% url scraper_code scraper.short_name %}">Code</a>
                </li>
                <li{% ifequal selected_tab "contributors" %} class="selected"{% endifequal %}>
                    <a href="{% url scraper_contributors scraper.short_name %}">Contributors
						{% with scraper.contributors.count as count %}
						    ({{ count|add:"1" }})
						{% endwith %}</a>
                </li>
                {% load comments %}
                <li{% ifequal selected_tab "comments" %} class="selected"{% endifequal %}>
                    <a href="{% url scraper_comments scraper.short_name %}">Notes &amp; questions 
                       {% get_comment_count for scraper as cc %}({{ cc }})</a>
                </li>
            </ul>
            
        </div>
        <div class="page_tab_body">
                    
            {% block tab %}
            {% endblock %}
        </div>
        <p class="report">
            <strong>Important</strong> If you suspect this scraper breaks our <a href="/terms_and_conditions/">Terms &amp; Conditions</a>, please <a href="/contact/">report it</a>
        </p>
    </div>
{% endblock %}
