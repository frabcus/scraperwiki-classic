{% extends "scraper/scraper_base.html" %}
{% load humanize %}
{% block tab %}
<table>
  <tr>
    <th>Date</th>
    <th>Action</th>
    <th>Message</th>
  </tr>
  {% for item in history %}
    <tr>
      <td>
        {{ item.datetime|date:"H:i, j F Y" }}
      </td>
      <td>
          {% ifequal item.message_type|lower "commit" %}
            Scraper committed
          {% endifequal %}

          {% ifequal item.message_type|lower "run_fail" %}
            Scraper run failed after {{ item.message_value|floatformat }}
          {% endifequal %}

          {% ifequal item.message_type|lower "run_success" %}
            Scraper run success after {{ item.message_value|floatformat }} seconds
          {% endifequal %}
          
          {% if item.user %}
            by <a href="{% url profiles_profile_detail item.user.username %}">
            {% load gravatar %} {% show_gravatar item.user 'small' %}&nbsp;{{item.user.get_profile.name}}</a>
          {% endif %}
        
        </td>
        <td>
          {% ifequal item.message_type|lower "commit" %}
              <em>{{item.message_value}}</em>
          {% else %}
              &nbsp;
          {% endifequal %}
        </td>
    </tr>
  {% endfor %}
</table>
{% endblock %}

{% block run_script %}
{% endblock %}
