{% extends "scraper/scraper_base.html" %}
{% load humanize %}
{% load sparkline %}

{% block tab %}
<div class="content col left">
    <h3>Description</h3>
    <p>{{ scraper.description }}</p>
    {% if has_data %}
        <h3>Example data</h3>
        <table class="raw_data">
            {% for heading, value in data %}
                <tr>
                    <td>{{heading}}</td>
                    <td>{{value}}</td>
                </tr>
            {% endfor %}
        </table>

    {% endif %}

</div>
<div class="content col right">
    <div class="metadata">
        <dl>
          <dt>Created by:</dt>
          <dd><a href="{% url profiles_profile_detail scraper.owner.username %}">
          {% load gravatar %} {% show_gravatar scraper.owner 'small' %}&nbsp;{{scraper.owner.get_profile.name}}</a></dd>
          <dt>Data licence:</dt>
          <dd>{{scraper.license|default:"&nbsp;"}}</dd>
          <dt>Scraper created:</dt><dd>{{ scraper.created_at|date:"H:i, j F Y" }}</dd>
          <dt>Last run:</dt>
          <dd>{{scraper.last_run|date:"H:i, j F Y"|default:"never"|title}}</dd>
          <dt>Records:</dt>
          <dd>{{ scraper.record_count }}</dd>
          <dt>API short name:</dt>
          <dd>{{scraper.short_name}}</dd>
          <dt>Language:</dt>
          <dd>{{scraper.language}}</dd>
          <dt>Data:</dt>
          <dd><a href="{% url export_csv scraper.short_name %}" rel="nofollow">download csv</a></dd>
          <dt>Tags:</dt>
          {% if scraper.published %}
              {% for tag in scraper_tags %}<dd><a href="{% url tag tag %}">{{ tag }}</a></dd>{% endfor %}
          {% else %}
              {% for tag in scraper_tags %}<dd>{{ tag }}</dd>{% endfor %}
          {% endif %}
        </dl>
    </div>
    <p>
        {% if chart_url %}
            <h4>Chart</h4>
            <a href='{{chart_url}}'><img src='{{chart_url}}'/></a>
        {% else %}
            <h4>Recent activity</h4>
            {% sparkline scraper.scraper_sparkline_csv 'medium' %}    
        {% endif %}
    </p>
    <h4>Contributors</h4>
    <ul>
        <li>
            <a href="{% url profiles_profile_detail scraper.owner.username %}">
            {% load gravatar %} {% show_gravatar scraper.owner 'small' %} 
            {{scraper.owner.get_profile.name}}</a>
            <em>(creator)</em>
        </li>
        {% if scraper_contributors %}  
          {% for contributor in scraper_contributors %}  
            <li>
            	{% load gravatar %} {% show_gravatar contributor 'small' %} 
                <a href="{% url profiles_profile_detail contributor.username %}">{{contributor.get_profile.name}}</a>
            </li>
          {% endfor %}
        {% endif %}
    </ul>
</div>
<br class="clear"/>
{% endblock %}
