{% extends "scraper/scraper_base.html" %}
{% load replace %}
{% block tab %}
<div class="tab_tools">
    {% if user_owns_it %}
        <form action="." method="post">
            <input type="hidden" id="hidDeleteData" name="delete_data" value="1" />
            <input type="submit" id="btnClearDatastore" class="button small danger" value="Clear the datastore?" {% if not has_data %}disabled="disabled"{% endif %}/>
        </form>
    {% endif %}
    {% if data_tables %}
        <a href="{% url export_csv scraper.short_name %}" rel="nofollow">download csv</a>
    {% else %}
        <span class="faux_link">download csv</span>
    {% endif %}
</div>

<div class="data_viewer">
    {% if has_data %}
        {% for table, data in data_tables.items %}
        <div class="raw_data">        
            <table class="raw_data">
                <thead>
                    <tr>
                        {% for heading in data.headings %}
                            <th>{{ heading }}</th>
                        {% endfor %}
                    </tr>
                </thead>
                <tbody>
                    {% for row in data.rows %}
                        <tr>
                            {% for value in row %}
                                <td>{{ value|urlizetrunc:15 }}</td>
                            {% endfor %}
                        </tr>
                    {% endfor %}    
                </tbody>
            </table>
        </div>
        {% endfor %}

    {% else %}
        <div class="raw_data">
        <table>
                <tbody>
                <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                <tr><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                </tbody>
            </table>
        </div>
	    <div class="info_unpublished">
            {% if scraper.published %}
	            This scraper has not been run yet <br/>
	            so there is nothing to display
            {% else %}
	            This scraper is being worked on <br/>but has not been published yet
	        {% endif %}
	    </div>


    {% endif %}
</div>
{% endblock %}
{% block run_script %}setupButtonConfirmation("btnClearDatastore", "Are you absolutely sure? THERE IS NO UNDO, clicking 'ok' will delete all existing data for this scraper.");{% endblock %}