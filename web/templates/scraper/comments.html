{% extends "scraper/scraper_base.html" %}
{% load humanize %}
{% block tab %}
{% load comments %}
{% load gravatar %}
<!-- {% render_comment_form for scraper %} -->
 <!-- {% render_comment_form for scraper.scraper scraper.pk %} -->
<span style="float: right"><a href="/feeds/scraper_comments/{{ scraper.short_name }}">RSS feed of comments</a></span>
  

 
 {% if user.is_authenticated %}
 
{% get_comment_form for scraper as form %}
<p>Add a comment or question about this scraper or the data it produces:</p>
<form action="{% comment_form_target %}" method="POST"> 
<table cellspacing="5"><tr><td valign="center" align="left">
   {% show_gravatar user 'medium' %} 
   </td>
   <td width="90%" valign="center" align="left">
	<textarea name="comment" id="id_comment" rows="2" style="width: 100%;"></textarea>
	{{ form.content_type }} 
	{{ form.object_pk }} 
	{{ form.timestamp }} 
	{{ form.security_hash }} 
	<!-- {{ form.honeypot }} -->
    <input type="hidden" name="next" value="{% url  scraper_comments scraper.short_name %}" />
    </td>
    <td valign="center" align="center">
	<input type="submit" value="Add" id="id_submit" /> 
	   </td>
	   </tr>
		   </table>
</form> 
{% else %}
    <p>Please <a href="/login/?next={{ request.get_full_path }}">log in</a> to add a comment.</p>
{% endif %}

{% get_comment_list for scraper as comment_list %}

{% if comment_list %}
<br/>
  {% for comment in comment_list reversed %} 
  {% show_gravatar comment.user 'small' %} 
    <em><a href="{% url profiles_profile_detail comment.name %}">{{ comment.name|escape }}</a> at {{ comment.submit_date|date:"r" }}</em>
    <link rel="#{{ comment.id }}">&nbsp;</link>
    <p>{{ comment.comment|escape|urlizetrunc:"100"|linebreaks }}</p>
    <hr> 
 {% endfor %} 
{% endif %}


<br/>
{% endblock %}
