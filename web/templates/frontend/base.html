<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
	<title>{% block title %}{% endblock %} | ScraperWiki</title>
<!--	<script type="text/javascript" src="{{ MEDIA_URL }}js/jquery-1.3.2.js"></script>	-->
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
<!-- <script type="text/javascript" src="{{ MEDIA_URL }}js/jquery-ui-1.7.2.custom.min.js"></script> -->
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/jquery.easing.compatibility.js"></script>		
	<script type="text/javascript" src="{{ MEDIA_URL }}js/jquery.cycle.all.min.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/jquery.jeditable.js"></script>		
	<script type="text/javascript" src="{{ MEDIA_URL }}js/jquery.simplemodal.1.4.js"></script>
    <script type="text/javascript" src="{{ MEDIA_URL }}js/json-min.js"></script>
	<script type="text/javascript" src="{{ MEDIA_URL }}js/flexigrid.js"></script>			
	<script type="text/javascript" src="{{ MEDIA_URL }}js/scraperwiki.js?{{settings.REVISION}}"></script>		
	<script type="text/javascript" src="{{ MEDIA_URL }}js/language-choice.js?{{settings.REVISION}}"></script>		
	{% block javascript %}{% endblock %}
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/jquery-ui.css" />
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/flexigrid.css" />
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/main.css?{{settings.REVISION}}" />
	{% block css %}{% endblock %}
	{% block rss %}{% endblock %}

	{% if not debug %}
	    <script type="text/javascript">

	      var _gaq = _gaq || [];
	      _gaq.push(['_setAccount', 'UA-21451224-1']);
	      _gaq.push(['_trackPageview']);

	      (function() {
	        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	      })();

	    </script>
	{% endif %}
</head>

{% load body_class %}
<body {%  body_class request %}>
	
	{% block nav_outer %}
	<div id="nav_outer">
		<div id="nav_inner">
			{% block nav %}
			<h1><a href="{% url frontpage %}">ScraperWiki</a></h1>
			<ul>
				<li class="frontpage"><a href="{% url frontpage %}">Home</a></li>
				<li class="about"><a href="{% url about %}">About</a></li>
				<li class="about"><a href="{% url scraper_list %}scrapers">Browse</a></li>
				<li class="blog"><a href="http://blog.scraperwiki.com">Blog</a></li>
				{% if user.is_authenticated %}
				<li class="user loggedin">
					<a href="{% url profiles_profile_detail user.username %}"><span>Logged in</span></a>
					<ul>
						<li class="hi">Hi {% if user.get_profile.name %}{{user.get_profile.name}}{% else %}{{user.username}}{% endif %}!</li>
						<li class="dashboard"><a href="{% url dashboard %}">Your dashboard</a></li>
						<li class="profile"><a href="{% url profiles_profile_detail user.username %}">Your profile</li>
						<li class="feedback"><a href="{% url contact_form %}">Give feedback</a></li>
						<li class="signout"><a href="{% url logout %}?next_page=/">Sign out</a></li>
					</ul>
				</li>
				{% else %}
				<li class="user login">
				    <a href="{% url login %}?next=/">Log in</a>
				    <ul>
						<li class="login_form">
						    <form method="post" action="{% url login %}">
                                <label for="id_user_or_email">Username or email:</label>
                                <input type="text" id="id_user_or_email" name="user_or_email" />
                                <label for="id_password">Password:</label>
                                <input type="password" id="id_password" name="password" />
                                <a id="forgotten" href="/accounts/password/reset/">Forgotten?</a>
                                <input type="submit" class="submit" id="submit" name="login" value="Log in" />
                                <span class="clear"></span>
                            </form>
						</li>
						<li class="signup"><a href="{% url login %}">Create an account</a></li>
					</ul>
				</li>
				{% endif %}
				<li class="search">
					<form id="navSearch" action="/search/" method="post">
		            	<input type="text" id="nav_search_q" name="q"/>
		            	<input type="submit" id="nav_search_go" value="Go" />
					</form>
				</li>
			</ul>
			{% endblock %}
		</div>
	</div>
	{% endblock %}

	{% block alert_outer %}
	<div id="alert_outer">
		<div id="alert_inner">
			{% block alert %}<h2>Here&rsquo;s an alert! <a href="foo">Linky linky.</a></h2>{% endblock %}
		</div>
	</div>
	{% endblock %}

	{% block header_outer %}
	<div id="header_outer">
		<div id="header_inner">
{% block header %}
			<h2>Page header</h2>
{% endblock %}
		</div>
	</div>
	{% endblock %}

	{% block content_outer %}
	<div id="page_outer">
		<div id="page_inner">
		
		{% block menu %}
		
		<div id="divMenu">
              <ul class="main_menu">
				{% if user.is_authenticated %}
                <li><a href="{% url dashboard %}" title="Manage your scrapers" class="dashboard">Your dashboard</a></li>
                {% endif %}
                <li><a href="{% url scraper_list %}scrapers" title="Browse all scrapers">Browse scrapers</a></li>
                <li><a href="{% url choose_template 'scraper' %}" title="Create a new screen scraper" class="editor_scraper">New scraper</a></li>
                <li><a href="{% url choose_template 'view' %}" title="Create a new view" class="editor_view">New view</a></li>
                <li><a href="{% url help 'tutorials' language|default:"python" %}" title="Help">Tutorials</a></li>
                <li><a href="{% url help 'documentation' language|default:"python" %}" title="Technical docs">Documentation</a></li>
                <li><a href="{% url get_involved %}" title="Get involved">Get involved!</a></li>
                {% if settings.ENABLE_MARKETPLACE %}
                    <li><a href="{% url market_list %}">Request a dataset</a></li>
                {% else %}
                    <li><a href="{% url request_data %}">Request data</a></li>
                {% endif %}
              </ul>

              <!-- <form id="divSidebarSearch" action="/search/" method="post">
                <input type="text" id="q" name="q"/>
                <input type="submit" id="go" value="Go" />
            </form> -->

              <ul class="sub_menu">
                 <li><a href="{% url about %}" title="About ScraperWiki">About ScraperWiki</a></li>
                   <li><a href="{% url contact_form %}" title="Feedback form">Contact us / Feedback</a></li>
                 <li><a href="{% url help 'faq' language|default:"python" %}" title="Frequently Asked Questions">Help &amp; FAQ&rsquo;s</a></li>
              </ul>
              <ul class="sub_menu"> 
                 <li><a href="http://blog.scraperwiki.com" title="ScraperWiki Data Blog"><span class="unimportant">Read our</span> blog</a></li>
                 <li><a href="http://groups.google.com/group/scraperwiki" title="Google groups"><span class="unimportant">Join our</span> email list</a></li>
                 <li><a href="http://twitter.com/scraperwiki" title="Follow us on Twitter"><span class="unimportant">Follow us on</span> Twitter</a></li>
                 <li><a href="https://www.facebook.com/pages/ScraperWiki/195413557138197" title="Like us on Facebook"><span class="unimportant">Visit us on</span> Facebook</a></li>
              </ul>

              {% if user.is_staff %}
              <ul class="sub_menu staff"> 
                  <li class="staff"><a href="/admin/">Django admin</a></li>
                  <li class="staff"><a href="{% url running_scrapers %}" title="Interact with current sandbox status">UML status</a></li>
                  <li class="staff"><a href="{% url kpi %}" title="Key performance indicators">KPIs</a></li>
              </ul>
              {% endif %}
            </div>
		
		{% endblock %}
		
		{% block above_page %}{% endblock %}		    

		<div id="divPage">
    		{% block tabs %}{% endblock %}
		    <div id="divContent">
    		    <div id="divInfo">
    		        {% if info_messages %}
                         <ul>
                             {% for info in info_messages %}
                                 <li>{{ info|escape }}</li>
                             {% endfor %}
                         </ul>
                     {% endif %}
                     {% if notifications %}
                     <ul>
                         {% for message in notifications %}
                     	{% if forloop.first %} {% comment %} Just get the first notification - otherwise login message displays twice, strange bug {% endcomment %}
                            <li {% if message.tags %}class="{{ message.tags }}"{% endif %}>{{ message }}</li>
                            {% endif %}
                         {% endfor %}
                     </ul>
                     {% endif %}
                     {% block info %}

           		     {% endblock %}
        		</div>
    		    <div id="divErrors">
    		        {% if error_messages %}
                         <ul>
                             {% for error in error_messages %}
                                 <li>{{ error|escape }}</li>
                             {% endfor %}
                         </ul>
                     {% endif %}
        		    {% block errors %}

        		    {% endblock %}		    
        		</div>
  		        {% block content %}{% endblock %}
  		        <br class="clear"/>
		    </div>
		</div>
		<br class="clear" />
	</div>
	{% endblock %}

	{% block footer_outer %}
	<div id="footer_outer">
		<div id="footer_inner">
			{% block footer %}
            {% load site_stats %}
			<p class="stats"><strong>{% num_data_rows %} rows of data</strong> <span>and counting&hellip;</span></p>
			<dl>
				<dt>About</dt>
				<dd>
					<ul>
						<li><a href="{% url about %}">About ScraperWiki</a></li>
						<li><a href="http://blog.scraperwiki.com">Blog</a></li>
						<li><a href="{% url terms %}">Terms &amp; conditions</a></li>
						<li><a href="{% url privacy %}">Privacy policy</a></li>
					</ul>
				</dd>
				<dt>Data</dt>
				<dd>
					<ul>
						<li><a href="{% url scraper_list %}scrapers">Browse data &amp; scrapers</a></li>
						{% if settings.ENABLE_MARKETPLACE %}
						<li><a href="{% url market_list %}">Request a dataset</a></li>
						{% else %}
						<li><a href="{% url request_data %}">Request data</a></li>
						{% endif %}
						<li><a href="#" class="editor_scraper">Create a scraper</a></li>
						<li><a href="#" class="editor_view">Create a view</a></li>		                 
						<li><a href="{% url get_involved %}" title="Get involved">Get involved!</a></li>
						<li><a href="{% url api:index %}">API</a></li>
					</ul>
				</dd>
				<!--<dt>Reuse the data</dt>
				<dd>
					<ul>
						<li><a href="{% url api:index %}">API</a></li>
						<li><a href="{% url api:libraries %}">Code libraries</a></li>			                 
					</ul>
				</dd>-->
				<dt>Help &amp; support</dt>
				<dd>
					<ul>
						<li><a href="{% url contact_form %}">Contact us</a></li>
						<li><a href="{% url help 'faq' language|default:"python" %}">FAQ</a></li>	
						<li><a href="{% url help 'tutorials' language|default:"python" %}">Tutorials</a></li>	
						<li><a href="{% url whitelist_user %}">Whitelist</a></li>	
						<li><a href="{% url help 'documentation' language|default:"python" %}">Code documentation</a></li>	
						<li><a href="http://groups.google.com/group/scraperwiki">Developers&rsquo; discussion group</a></li>			                   			                 
					</ul>
				</dd>
			</dl>
			<div id="divCopyright">&copy; ScraperWiki Ltd</div>
			<img src="{{ MEDIA_URL }}images/footer_tractor.png" width="140" height="90" alt="" />
			{% endblock %}
		</div>
	</div>
	{% endblock %}

    <script type="text/javascript" defer="defer">
    {% block run_script %}{% endblock %}
    </script>

{% if sqldebug %}
<div id="debug">
  <p>
    {{ sqldebug.queries.count }} Quer{{ sqldebug.queries|pluralize:"y,ies" }}, {{ sqldebug.time }} seconds
    {% ifnotequal sql_queries|length 0 %}
    (<span style="cursor: pointer;" onclick="var s=document.getElementById('debugQueryTable').style;s.display=s.display=='none'?'':'none';this.innerHTML=this.innerHTML=='Show'?'Hide':'Show';">Show</span>)
    {% endifnotequal %}
  </p>
  <table id="debugQueryTable" style="display: none;">
    <col width="1"></col>
    <col></col>
    <col width="1"></col>
    <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">SQL</th>
      <th scope="col">Time</th>
    </tr>
    </thead>
    <tbody>
    {% for query in sqldebug.queries %}<tr class="{% cycle odd,even %}">
      <td>{{ forloop.counter }}</td>
      <td>{{ query|safe }}</td>
      <td>{{ query.time }}</td>
    </tr>{% endfor %}
    </tbody>
  </table>
</div>
{% endif %}
	
</body>

</html>
