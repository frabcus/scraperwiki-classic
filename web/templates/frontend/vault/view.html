{% extends "frontend/base.html" %}
{% load gravatar %}

{% block title %}Your vaults{% endblock %}

{% block header %}
	<h2>Your vaults</h2>

	<p>Information about your vaults and who can access them</p>
{% endblock %}


{% block content %}

<div class="content">

{% if vaults.count %}
<div id="my_vaults">
    <h2>You own {{ vaults.count }} vault{{ request.user.vault_membership.count|pluralize }}:</h2>
{% for vault in vaults.all %}
    <div class="vault">
 <h3>{{ vault.name }} ({{ vault.plan|lower }} plan)</h3>

	{% if vault.code_objects %}
	 <h4>This vault contains {{ vault.code_objects.count }} item{{ vault.code_objects.count|pluralize }}</h4>
	 <ul>
		{% for s in vault.code_objects.all %}
			<li>			
				<a href="{% url code_overview s.wiki_type,s.short_name %}">{{ s.short_name }} </a>
			</li>
		{% endfor %}
	 </ul>
	{% endif %}

	{% ifequal vault.user request.user %}
		 <h4>{{ vault.members.count }} other {{ vault.members.count|pluralize:"person,people" }} can access this vault</h4>
		 <ul>
			{% for m in vault.members.all %}
				<li>			
					{% show_gravatar m 'medium' %}
					<a href="{% url profiles_profile_detail m.username %}">{{ m.get_profile.name }} ({{m.username}})</a>
					<a href="{% url vault_user vault.id, m.username,'remove' %}">remove</a>
				</li>
			{% endfor %}
		 </ul>
	
	     <div id="addneweditor">
	      <span class="hide">
	        Editor username:
	        <input type="text" class="text">
	        <input type="button" value="Cancel" class="cancelbutton">
	        <input type="button" value="Add" class="addbutton">
	      </span>
	      <a><img src="{{ MEDIA_URL }}images/icons/add.png" width="16" height="16" /> Add a new member
	        <img id="contributors_loading" src="{{ MEDIA_URL }}images/load.gif" style="display: none">
	      </a>
	    </div> 
	    <div id="contributorserror" style="display: none">
	        None
	    </div>
		{% endifequal %}
</div>
<hr/>
{% endfor %}
</div>
{% endif %}

{% if request.user.vault_membership.count %}
<div id="shared_vaults">	
    <h2>You can access {{ request.user.vault_membership.count }} shared vault{{ request.user.vault_membership.count|pluralize }}:</h2>
	
	{% for v in request.user.vault_membership.all %}
	<div class="vault">
	<h3>{{ v.name }} ({{ v.user.username }}&rsquo;s vault)</h3>

    	{% if v.code_objects %}
    	 <h4>This vault contains {{ v.code_objects.count }} item{{ v.code_objects.count|pluralize }}</h4>
    	 <ul>
    		{% for s in v.code_objects.all %}
    			<li>			
    				<a href="{% url code_overview s.wiki_type,s.short_name %}">{{ s.short_name }} </a>
    			</li>
    		{% endfor %}
    	 </ul>
    	 {% endif %}
	</div>
	{% endfor %}
</div>
{% endif%}

</div>


{% endblock %}
