{% extends "codewiki/scraper_base.html" %}
{% load humanize %}
{% load markup %}
{% block tab %}
{% load screen_shot %}

    <div class="content full">
        <div class="screenshot_large">
          <a href="{% url view_fullscreen scraper.short_name %}">
              <span>Click to open this view</span>
          </a>
          {% screen_shot scraper 'large' %}
       </div>
    </div>

    <div class="content full">
        <h2>About this view {% if user.is_authenticated %}<a href="{% url scraper_admin scraper.short_name %}" id="aEditAboutScraper" class="edit">[edit description]</a>{% else %}<a href="{% url login %}?next={% url code_overview 'view' scraper.short_name %}" class="edit">[sign in to edit description]</a>{% endif %}</h2>        
        <div class="text_wiki">
            <div id="divAboutScraper">{{ scraper.description|textile }}</div>
        </div>
    </div>
    <div class="content col left">
        <h3>Contributors</h3>
        {% include 'codewiki/includes/contributors.html' %}
    </div>
        <div class="content col right">
            {% if related_scrapers %}            
                <h3>Scrapers used in the making of this view</h3>
                <ul>
                    {% for related_scraper in related_scrapers %}
                        <a href="{% url code_overview related_scraper.wiki_type related_scraper.short_name %}">{{related_scraper.title}}</a>
                    {% endfor %}
                </ul>
            {% endif %}
            <h3>Delete &amp; reset</h3>
             {% if user_owns_it %}    
                 <form action="{% url scraper_delete_scraper 'view' scraper.short_name %}" method="post">
                     <input type="hidden" name="delete_scraper" value="1" />
                     <input type="submit" id="btnDeleteScraper" class="danger" value="Delete this view?" />
                     <p>Deletes this view. There is no undo.</p>
                 </form>
             {% else %}
                 <p class="infobox">Only the creator of a view can delete it.</p>
             {% endif %}
        </div>
    <br class="clear"/>    
    <div class="content full">
      <a name="embed"></a>
      <h3>Add this view to your site</h3>
      <code>
      {% filter force_escape|linebreaksbr %}
        <div>
          <iframe width="100%" height="400px" src="http://{{settings.VIEW_DOMAIN}}{% url rpcexecute scraper.short_name %}"></iframe>
          <img src="http://scraperwiki.com/media/images/powered.png" alt="Powered by ScraperWiki.com" />
        </div>
      {% endfilter %}
      </code>
    </div>
    <br class="clear"/>  
{% endblock %}
{% block run_script %}
    {% if user.is_authenticated %}
        setupScraperEditInPlace('view', '{{scraper.short_name}}');
        setupButtonConfirmation("btnDeleteScraper", "Are you absolutely sure? THERE IS NO UNDO, clicking 'ok' will delete this view.");
    {% endif %}
{% endblock %}
